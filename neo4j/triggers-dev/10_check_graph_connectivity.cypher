CALL apoc.trigger.add( 'check_graph_connectivity_global', ' MATCH (start) WITH start LIMIT 1  MATCH (start)-[*]-(reachable) WITH collect(id(reachable)) AS reachIds MATCH (n) WITH reachIds, collect(id(n)) AS allIds WITH reachIds, allIds, [x IN allIds WHERE NOT x IN reachIds] AS missingIds OPTIONAL MATCH (m) WHERE id(m) IN missingIds WITH [m IN collect(m) | coalesce(m.name, head([lab IN labels(m) | lab]), toString(id(m)))] AS notReachable  CALL apoc.util.validate( size(notReachable) > 0, "/*Connectivity violation: the graph is not connected. Unreachable nodes: " + apoc.text.join(notReachable, ", ") + "*/", [] ) RETURN true ', {phase: 'before'} );